
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Pr&aacute;ctica 7:  Respuesta en frecuencia, Simulink</title><meta name="generator" content="MATLAB 9.0"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2017-06-13"><meta name="DC.source" content="Practica8ASySmayo2017.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Pr&aacute;ctica 7:  Respuesta en frecuencia, Simulink</h1><!--introduction--><p>Los filtros (sistemas LTI) son importantes en el &aacute;rea de procesamiento de se&ntilde;ales. Las caracteristicas del filtrado de un sistema diferencial LTI (ecuaci&oacute;n diferencial con coeficientes constantes y condicinones iniciales cero) est&aacute;n determinadas por lo siguiente:</p><p>Si la entrada a un sistema BIBO-estable es</p><p><img src="Practica8ASySmayo2017_eq10301821981762913887.png" alt="$$x(t)= A\cos(\omega t + \theta)u(t)$$"></p><p>La salida en estado estacionario (coincide con la particular o forzada), para un sistema asintoticamente estable, ser&aacute;</p><p><img src="Practica8ASySmayo2017_eq06408195996506512253.png" alt="$$y_{ss}(t)=A|H(j\omega)|\cos(\omega t+ \theta + ang H(j\omega))u(t)$$"></p><p>Podemos decir lo siguiente: Si una se&ntilde;al coseno (o seno) es la entrada de un sistema LTI BIBO-estable y asintoticamente estable, la respuesta en estado estacionario es un escalamiento vertical y una traslaci&oacute;n horizontal de la se&ntilde;al de entrada.</p><p>Si el escalamiento vertical dado es muy peque&ntilde;o <img src="Practica8ASySmayo2017_eq17854136212578998407.png" alt="$|H(j\omega)|<< 1$"> la respuesta en estado estacionario tiene un efecto despreciable en la salida del sistema, entonces diremos que el sistema filtra a esta se&ntilde;al ("no la deja pasar para llegar a la salida del sistema", por lo que los sistemas LTI son filtros) pero esto no siempre es el caso, podr&iacute;a suceder que el escalamiento vertical no sea tan peque&ntilde;o, entonces la respuesta en estado estacionario no ser&iacute;a despreciable</p><p>El escalamiento vertical depende de dos cosas, de la estructura del sistema (cuantas derivadas hay en la entrada y la salida y los coeficientes de estas) y de los valores de <img src="Practica8ASySmayo2017_eq08589834809570054062.png" alt="$\omega$">.  As&iacute; para un sistema fijo <img src="Practica8ASySmayo2017_eq17354617462179732091.png" alt="$H$"> el escalamiento vertical y la traslaci&oacute;n horizontal (o desfasamiento) depende solo de los  valos de <img src="Practica8ASySmayo2017_eq08589834809570054062.png" alt="$\omega$">, esto es, de la frecuencia de la entrada (ya sea una funci&oacute;n seno o coseno). Entonces ser&iacute;a conveniente tener registrados los escalamientos y traslaciones de la se&ntilde;al de salida en estado estacionario de alguna manera.</p><p>A la expresi&oacute;n <img src="Practica8ASySmayo2017_eq03286531877702067301.png" alt="$H(j\omega)$"> se le conoce como la respuesta en <b>frecuencia del sistema</b> (es decir, la respuesta en frecuencia es la funci&oacute;n de transferencia en el formato de transformada de Fourier) y la manera de registrar la informaci&oacute;n que contiene es mediante las gr&aacute;ficas <img src="Practica8ASySmayo2017_eq05350563964374045882.png" alt="$|H(j\omega)|$"> contra <img src="Practica8ASySmayo2017_eq08589834809570054062.png" alt="$\omega$"> (gr&aacute;fica de magnitud) y <img src="Practica8ASySmayo2017_eq10213805769844734543.png" alt="$ang(H(j\omega))$">  contra <img src="Practica8ASySmayo2017_eq08589834809570054062.png" alt="$\omega$"> (gr&aacute;fica de fase) (con <img src="Practica8ASySmayo2017_eq08589834809570054062.png" alt="$\omega$"> de 0 a <img src="Practica8ASySmayo2017_eq16739024125614530807.png" alt="$\infty$">) y precisamente estas gr&aacute;ficas nos ayudan a interpretar el sistema como filtro, est&aacute;s gr&aacute;ficas son las que se estudian cuando se habla de la respuesta en frecuencia mas que la espresi&oacute;n an&aacute;litica <img src="Practica8ASySmayo2017_eq03286531877702067301.png" alt="$H(j\omega)$"> en si.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Ejemplo:</a></li><li><a href="#4">Gr&aacute;ficas de Bode</a></li><li><a href="#5">Gr&aacute;ficas de bode de constantes</a></li><li><a href="#6">Gr&aacute;ficas de bode de potencias</a></li><li><a href="#8">Gr&aacute;ficas de bode de factores lineales</a></li><li><a href="#10">Gr&aacute;ficas de bode de factores cuadraticos</a></li><li><a href="#12">Analisis de un sistema de segundo orden no amortiguado</a></li><li><a href="#13">Representaci&oacute;n de un sistema LTI en MATLAB</a></li><li><a href="#14">Respuesta al escal&oacute;n (condiciones iniciales cero)</a></li><li><a href="#15">Polos y ceros del sistema</a></li><li><a href="#16">Respuesta al impulso (condiciones iniciales cero)</a></li><li><a href="#17">Respuesta a entradas sinusoidales</a></li><li><a href="#18">Respuesta en frecuencia</a></li><li><a href="#19">Modelo de suspensi&oacute;n de un carro</a></li><li><a href="#20">Parametros del modelo</a></li><li><a href="#21">Funci&oacute;n de transferencia: Entrada- Salidida</a></li><li><a href="#22">Ceros y polos del sistema</a></li><li><a href="#23">Respuesta del sistema al escal&oacute;n (conidiciones iniciales cero)</a></li><li><a href="#24">Respuesta al impulso (condiciones iniciales cero)</a></li><li><a href="#25">Respuesta a una entrada sinusoidal</a></li><li><a href="#26">Respuesta en frecuencia del sistema</a></li><li><a href="#27">Efectos de variar el amortiguamiento en la respuesta en frecuencia</a></li><li><a href="#28">Efecto de variar la masa en la respuesta en frecuencia</a></li><li><a href="#29">Simulaci&oacute;n mediante c&oacute;digo:</a></li><li><a href="#30">Simulaci&oacute;n con simulink</a></li><li><a href="#31">Simulaci&oacute;n</a></li></ul></div><h2>Ejemplo:<a name="1"></a></h2><p>Encuentra la respuesta en frecuencia de</p><p><img src="Practica8ASySmayo2017_eq13079118590907421009.png" alt="$$\ddot{y}+3\dot{y}+2y=\dot{x}+5x$$"></p><p>&iquest;Cu&aacute;l es la respuesta en estado estacionario cuando la entrada es <img src="Practica8ASySmayo2017_eq07498964601539213209.png" alt="$x(t)=20sen(3t+2)$">?</p><p>Se suele utilizar a la letra <img src="Practica8ASySmayo2017_eq17157792396909321071.png" alt="$s$"> para escribir a la funci&oacute;n de transferencia, aunque en este estudio nos conviene ver a la funci&oacute;n de transferecia en su notaci&oacute;n de transformada de Fourier, as&iacute; sustituimos a <img src="Practica8ASySmayo2017_eq12362541531082859251.png" alt="$s=j\omega$"></p><p><img src="Practica8ASySmayo2017_eq09828250958958545764.png" alt="$$H(s)=\frac{P(s)}{Q(s)}=\frac{s+5}{s^2+3s+2}$$"></p><p><img src="Practica8ASySmayo2017_eq02119358755894772182.png" alt="$$H(j\omega)=\frac{j\omega+5}{(j\omega)^2+3(j\omega)+2}=\frac{5+\omega j}{2-\omega^2+3\omega j}$$"></p><p>Aqu&iacute; <img src="Practica8ASySmayo2017_eq15415948677251620528.png" alt="$\omega=3$">, entonces</p><p><img src="Practica8ASySmayo2017_eq01943964342198425583.png" alt="$$H(3j)=\frac{j3+5}{(j3)^2+3(j3)+2}=\frac{5+3j}{-7+9j}$$"></p><p><img src="Practica8ASySmayo2017_eq13299923747676175886.png" alt="$$|H(3j)|=\frac{5.831}{11.402}=0.51141$$"></p><p><img src="Practica8ASySmayo2017_eq09155737802809522977.png" alt="$$ang H(3j)=0.54042-2.2318=-1.6914$$"></p><p>Entonces la respuesta en estado estacionario es</p><p><img src="Practica8ASySmayo2017_eq17791376955496250737.png" alt="$$y_{ss}(t)=20(0.51141)sen(3t+2-1.6914)u(t)=10.228sen(3t+0.3086)u(t)$$"></p><p>Ahora podemos resolver este sistema para condiciones iniciales cero y la entrada establecida, observemos que la soluci&oacute;n es la respuesta total y en principio la soluci&oacute;n  no permite mostrar la respuesta en estado estacionario encontrada, pero mediante simplificaci&oacute;n se puede ver que coicide con la soluci&oacute;n del ejemplo anterior. Este sistema es asintoticamente estable y por lo tanto BIBO estable, entonces la respuesta transitoria tiende a ser despreciable desp&uacute;es de un largo tiempo, entonces si gr&aacute;ficamos la respuesta estacionario encontrada en el ejemplo anterior tenemos que</p><pre class="codeinput">syms <span class="string">t</span>
rg=laplace2016am([2 3 1],[5 1],[0 0],[0],20*sin(3*t+2)*heaviside(t),10);
tt=0:0.01:10;
plot(rg,tt,10.228*sin(3*tt+0.3086),<span class="string">'k'</span>)
</pre><pre class="codeoutput"> 
APLICAMOS TRANSFORMADA DE LAPLACE y subtituimos condiciones iniciales
 
                     2
2 Y(s) + 3 s Y(s) + s  Y(s)

=
5 X(s) + s X(s)

 
SUBSTITUIMOS LA TRANSFORMADA DE LA ENTRADA
 
                     2
2 Y(s) + 3 s Y(s) + s  Y(s)

=
300 cos(2)     / 60 cos(2)   20 s sin(2) \   100 s sin(2)
---------- + s | --------- + ----------- | + ------------
   2           |    2            2       |       2
  s  + 9       \   s  + 9       s  + 9   /      s  + 9

 
DESPEJAMOS Y(s)
 
Y(s)=
                                              2
300 cos(2) + 60 s cos(2) + 100 s sin(2) + 20 s  sin(2)
------------------------------------------------------
              4      3       2
             s  + 3 s  + 11 s  + 27 s + 18

 
DESARROLLAMOS LAS FRACCIONES PARCIALES DE Y(s)
 
Y(s)=
                       180 cos(2)   120 sin(2)
                       ---------- - ----------
24 cos(2) - 8 sin(2)       13           13
-------------------- - -----------------------
        s + 1                   s + 2

     48 cos(2)   396 sin(2)     / 132 cos(2)   16 sin(2) \
     --------- - ---------- + s | ---------- + --------- |
         13          13         \     13           13    /
   - -----------------------------------------------------
                              2
                             s  + 9

 
Aplicamos transformada inversa, asi la soluci&oacute;n es
 
y(t)=
sin(3 t) sin(2) 132   sin(3 t) cos(2) 16   cos(3 t) sin(2) 16
------------------- - ------------------ - ------------------
         13                   13                   13

                                                / 180 cos(2)   120 sin(2) \
   + exp(-t) (24 cos(2) - 8 sin(2)) - exp(-2 t) | ---------- - ---------- |
                                                \     13           13     /

     cos(3 t) cos(2) 132
   - -------------------
              13

</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_01.png" alt=""> <p>La funci&oacute;n <tt>laplace2016am</tt> es una modificaci&oacute;n de un programa que ya hemos utilizado donde nos regresa una ubicaci&oacute;n para gr&aacute;ficar en donde corresponde a la respuesta en estado estacionario, no hay mayor importancia en esto solo es para un despliegue m&aacute;s amigable.</p><p>A continuaci&oacute;n calculamos la gr&aacute;fica de Magnitud y de fase para el sistema antes mencionado, mediante la defici&oacute;n directa y mediante la herramienta de Matlab con la intrucci&oacute;n <tt>bode</tt>. Adem&aacute;s observamos que estas gr&aacute;fica tienen la informaci&oacute;n de la magnitud y angulo para diferentes valores de <img src="Practica8ASySmayo2017_eq08589834809570054062.png" alt="$\omega$"> en particu&ntilde;ar cuando <img src="Practica8ASySmayo2017_eq15415948677251620528.png" alt="$\omega=3$">, hay que tener cuidado por lo regular la gr&aacute;fica de fase se reporta en grados.</p><pre class="codeinput">w = [0:0.1:100];
absH =inline(<span class="string">'(25+w.^2).^0.5./((2-w.^2).^2+9*w.^2).^.5'</span>,<span class="string">'w'</span>);
angH = inline(<span class="string">'atan2d(w,5)-atan2d(3*w,(2-w.^2))'</span>,<span class="string">'w'</span>);
figure
subplot(1,2,1)

plot(w,absH(w))
hold <span class="string">on</span>
p2=plot(3,absH(3),<span class="string">'ro'</span>);
legend(p2,<span class="string">'Escalamiento para w=3'</span>)
grid <span class="string">on</span>
title(<span class="string">'|H(j\omega)|'</span>)
xlabel(<span class="string">'\omega'</span>)

subplot(1,2,2)
plot(w,angH(w))
hold <span class="string">on</span>
p3=plot(3,angH(3),<span class="string">'ro'</span>);
legend(p3,<span class="string">'traslaci&oacute;n (en grados) para w=3'</span>)
grid <span class="string">on</span>
title(<span class="string">'\angle H(j\omega)'</span>)
xlabel(<span class="string">'\omega'</span>)

sistema = tf([1 5],[1 3 2])

[m,a,wb] = bode(sistema);
mm = squeeze(m);
aa = squeeze(a);

figure
subplot(1,2,1)
plot(wb,mm)
grid <span class="string">on</span>
title(<span class="string">'|H(j\omega)|'</span>)
xlabel(<span class="string">'\omega'</span>)

subplot(1,2,2)
plot(wb,aa)
grid <span class="string">on</span>
title(<span class="string">'\angle H(j\omega)'</span>)
xlabel(<span class="string">'\omega'</span>)
</pre><pre class="codeoutput">
sistema =
 
      s + 5
  -------------
  s^2 + 3 s + 2
 
Continuous-time transfer function.

</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_02.png" alt=""> <img vspace="5" hspace="5" src="Practica8ASySmayo2017_03.png" alt=""> <h2>Gr&aacute;ficas de Bode<a name="4"></a></h2><p>Las gr&aacute;ficas de Bode son escalas de las graficas de magnitud y fase, estas escalas se remontan a la decada de 1930-1940, nos permiten elaborar las gr&aacute;ficas de una manera "amigable" y tienen una mejor visualizaci&oacute;n que las escalas naturales, aunque en un principio la interpretaci&oacute;n de la magnitud y el desplazamiento (fase) pueden parecer un poco extra&ntilde;as, son las mismas que hemos comentado anteriormente.</p><p>La gr&aacute;fica de magnitud de bode es gr&aacute;ficar <img src="Practica8ASySmayo2017_eq16088251650401086086.png" alt="$20 log_{10}(|H(j\omega)|)$">, contra <img src="Practica8ASySmayo2017_eq01103843110307182660.png" alt="$log_{10}(\omega)$">.</p><p>La gr&aacute;fica de fase de bode es gr&aacute;ficar <img src="Practica8ASySmayo2017_eq00362685599678487040.png" alt="$ang(|H(j\omega)|)$">, contra <img src="Practica8ASySmayo2017_eq01103843110307182660.png" alt="$log_{10}(\omega)$">.</p><p>Tenemos la siguiente definici&oacute;n, si a un n&uacute;mero positivo <img src="Practica8ASySmayo2017_eq05508344529756732484.png" alt="$a$"> le realizamos la operacion de la forma <img src="Practica8ASySmayo2017_eq09357799442181133718.png" alt="$20log_{10}(a)$"> diremos que el resultado es el valor en decibeles del n&uacute;mero a, es decir la gr&aacute;fica de Bode de magnitud se mide en decibeles.</p><p>Pensemos en la siguiente funci&oacute;n de transferencia</p><p><img src="Practica8ASySmayo2017_eq01946719981347217119.png" alt="$$H(s)=\frac { K(s+{ a }_{ 1 })(s+{ a }_{ 2 }) }{ s(s+b_{ 1 })({ s }^{ 2 }+{ b }_{ 2 }s+{ b }_{ 3 }) } $$"></p><p>Factorizamos las constantes necesarias de tal manera que el termino independiente de cada componente de la factorizaci&oacute;n sea uno. Esto servir&aacute; para el an&aacute;lisis posterior</p><p><img src="Practica8ASySmayo2017_eq04188429822957726002.png" alt="$$H(s)=\frac { K{ a }_{ 1 }{ a }_{ 2 } }{ { b }_{ 1 }{ b }_{ 3 } } \frac { \left( \frac { s }{ { a }_{ 1 } } +1 \right) \left( \frac { s }{ { a }_{ 2 } } +1 \right)  }{ s\left( \frac { s }{ { b }_{ 1 } } +1 \right)\left( \frac { s^{ 2 } }{ { b }_{ 3 } } +\frac { { b }_{ 2 } }{ { b }_{ 3 } } s+1 \right)  }&#xA;$$"></p><p>Sustituimos <img src="Practica8ASySmayo2017_eq12362541531082859251.png" alt="$s=j\omega$"> para encontrar la funci&oacute;n del escalamiento y traslaci&oacute;n</p><p><img src="Practica8ASySmayo2017_eq11591740307644002137.png" alt="$$&#xA;H(j\omega )=\frac { K{ a }_{ 1 }{ a }_{ 2 } }{ { b }_{ 1 }{ b }_{ 3 } } \frac { \left( 1+\frac { j\omega  }{ { a }_{ 1 } }  \right) \left( 1+\frac { j\omega  }{ { a }_{ 2 } }  \right)  }{ j\omega \left( 1+\frac { j\omega  }{ { b }_{ 1 } }  \right) \left[ 1+j\frac { { b }_{ 2 }\omega  }{ { b }_{ 3 } } +\frac { { (j\omega ) }^{ 2 } }{ { b }_{ 3 } }  \right]  }&#xA;$$"></p><p>As&iacute; la magnitud del escalamiento queda como</p><p><img src="Practica8ASySmayo2017_eq14528093951673860315.png" alt="$$&#xA;\left| H(j\omega ) \right| =\frac { K{ a }_{ 1 }{ a }_{ 2 } }{ { b }_{ 1 }{ b }_{ 3 } } \frac { \left| 1+\frac { j\omega  }{ { a }_{ 1 } }  \right| \left| 1+\frac { j\omega  }{ { a }_{ 2 } }  \right|  }{ \left| j\omega  \right| \left| 1+\frac { j\omega  }{ { b }_{ 1 } }  \right| \left| 1+j\frac { { b }_{ 2 }\omega  }{ { b }_{ 3 } } +\frac { { (j\omega ) }^{ 2 } }{ { b }_{ 3 } }  \right|  }&#xA;$$"></p><p>Y la traslaci&oacute;n</p><p><img src="Practica8ASySmayo2017_eq02908802111943748451.png" alt="$$&#xA;\angle H(j\omega )=\angle\left(\frac { K{ a }_{ 1 }{ a }_{ 2 } }{ { b }_{ 1 }{ b }_{ 3 } }\right)+\angle \left( 1+\frac { j\omega  }{ { a }_{ 1 } }  \right) +\angle \left( 1+\frac { j\omega  }{ { a }_{ 2 } }  \right) -\angle j\omega -\angle \left( 1+\frac { j\omega  }{ { b }_{ 1 } }  \right) -\angle \left[ 1+j\frac { { b }_{ 2 }\omega  }{ { b }_{ 3 } } +\frac { { (j\omega ) }^{ 2 } }{ { b }_{ 3 } }  \right]&#xA;$$"></p><p>El valor en decibeles de la magnitud queda como</p><p><img src="Practica8ASySmayo2017_eq10091464106586814346.png" alt="$$ 20log\left| H(j\omega ) \right| =20log\left|\frac { K{ a }_{ 1 }{ a }_{ 2 } }{ { b }_{ 1 }{ b }_{ 3 } } \right|+20log\left| 1+\frac { j\omega  }{ { a }_{ 1 } }  \right| +20log\left| 1+\frac { j\omega  }{ { a }_{ 2 } }  \right| -20log\left| j\omega  \right| -20log\left| 1+\frac { j\omega  }{ { b }_{ 1 } }  \right|  \\&#xA;-20log\left| 1+j\frac { { b }_{ 2 }\omega  }{ { b }_{ 3 } } +\frac { {&#xA;(j\omega ) }^{ 2 } }{ { b }_{ 3 } } \right| $$"></p><h2>Gr&aacute;ficas de bode de constantes<a name="5"></a></h2><p>Si la funci&oacute;n de transferencia es una constante, la grafica de la magnitud son lineas horizontales y la fase es de <img src="Practica8ASySmayo2017_eq00202142981986870057.png" alt="$0$"> o <img src="Practica8ASySmayo2017_eq17224572890734814492.png" alt="$180$"> grados dependiendo del signo Pensemos en la siguiente funci&oacute;n  de transferencia:</p><p><img src="Practica8ASySmayo2017_eq05806392582715673977.png" alt="$$H(j\omega)=a\;\; a\in R$$"></p><p><img src="Practica8ASySmayo2017_eq07595746186790454736.png" alt="$$20log|H(j\omega)|=20log|a|$$"></p><p>Para a positiva <img src="Practica8ASySmayo2017_eq10550906455228954231.png" alt="$ang(H(j\omega))=0$"> y para a negativa <img src="Practica8ASySmayo2017_eq12928686696674712654.png" alt="$ang(H(j\omega))=180$"></p><pre class="codeinput">figure
bode(5,1)
figure
bode(-5,1)
<span class="comment">%</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_04.png" alt=""> <img vspace="5" hspace="5" src="Practica8ASySmayo2017_05.png" alt=""> <h2>Gr&aacute;ficas de bode de potencias<a name="6"></a></h2><p>Pensemos en la siguiente funci&oacute;n  de transferencia:</p><p><img src="Practica8ASySmayo2017_eq03400426033207877590.png" alt="$$H(j\omega)=\frac{1}{jw}$$"></p><p>La magnitud en decibeles queda como:</p><p><img src="Practica8ASySmayo2017_eq00019275420098392478.png" alt="$$20log|H(j\omega)|=-20log|\omega|=-20log(\omega)=-20u$$"></p><p>La traslaci&oacute;n queda como:</p><p><img src="Practica8ASySmayo2017_eq11533429813827079762.png" alt="$$\angle H(j\omega )=-\angle \left( j\omega \right)=- 90$$"></p><pre class="codeinput">figure
hold <span class="string">on</span>
<span class="comment">% Iteraci&oacute;n sobre diferentes valores</span>
d=[1];
<span class="keyword">for</span> i = 1:4
    d=[d 0];
	bode(tf(1,d))
	pause(0.5)
	drawnow
<span class="keyword">end</span>
grid <span class="string">on</span>
legend(<span class="string">'1/(j\omega)^1'</span>,<span class="string">'1/(j\omega)^2'</span>,<span class="string">'1/(j\omega)^3'</span>,<span class="string">'1/(j\omega)^4'</span>,<span class="string">'Location'</span>,<span class="string">'SW'</span>)
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_06.png" alt=""> <p>Se puede deducir de manera semejante si el factor esta en el numerador claro que habra un peque&ntilde;o cambio de signo por las porpiedades de la funci&oacute;n logaritmo</p><pre class="codeinput">figure
hold <span class="string">on</span>
<span class="comment">% Iteraci&oacute;n sobre diferentes valores</span>
n=[1];
<span class="keyword">for</span> i = 1:4
    n=[n 0];
	bode(tf(n,1))
	pause(0.5)
	drawnow
<span class="keyword">end</span>
grid <span class="string">on</span>
legend(<span class="string">'(j\omega)^1'</span>,<span class="string">'(j\omega)^2'</span>,<span class="string">'(j\omega)^3'</span>,<span class="string">'(j\omega)^4'</span>,<span class="string">'Location'</span>,<span class="string">'SW'</span>)
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_07.png" alt=""> <h2>Gr&aacute;ficas de bode de factores lineales<a name="8"></a></h2><p>Pensemos en la siguiente funci&oacute;n de transferencia</p><p><img src="Practica8ASySmayo2017_eq00823951480614761909.png" alt="$$H(j\omega)=\frac{1}{\left(1+\frac{j\omega}{a}\right)}$$"></p><p>La magnitud en decibeles queda como:</p><p><img src="Practica8ASySmayo2017_eq07789661923658061363.png" alt="$$20log|H(j\omega)|=-20log\left| 1+\frac { j\omega  }{ a } \right|$$"></p><p>Cuando <img src="Practica8ASySmayo2017_eq14199787550441964666.png" alt="$\omega<<a$"> entonces</p><p><img src="Practica8ASySmayo2017_eq13017800658564115980.png" alt="$$20log|H(j\omega)|=-20log\left| 1+\frac { j\omega  }{ a } \right|\approx -20log(1)=0$$"></p><p>Cuando <img src="Practica8ASySmayo2017_eq00112265347517420439.png" alt="$\omega&gt;&gt;a$"> entonces</p><p><img src="Practica8ASySmayo2017_eq04709684965959503979.png" alt="$$20log|H(j\omega)|=-20log\left| 1+\frac { j\omega  }{ a }  \right| \approx -20log\left( \frac { \omega  }{ a }  \right) =-20log\omega +20loga=-20u+20log(a)$$"></p><p>&iquest;Qu&eacute; pasa cuando <img src="Practica8ASySmayo2017_eq05177830494923879950.png" alt="$\omega=a$">?</p><p>La traslaci&oacute;n queda como:</p><p><img src="Practica8ASySmayo2017_eq04041986817752999721.png" alt="$$\angle H(j\omega )=-\angle \left( 1+\frac { j\omega  }{ a }  \right) =-{ tan }^{ -1 }\left( \frac { \omega  }{ a }  \right)$$"></p><p>Cuando <img src="Practica8ASySmayo2017_eq14199787550441964666.png" alt="$\omega<<a$"> entonces</p><p><img src="Practica8ASySmayo2017_eq17847761918322843795.png" alt="$$\angle H(j\omega )=-{ tan }^{ -1 }\left( \frac { \omega  }{ a }  \right) \approx 0 $$"></p><p>Cuando <img src="Practica8ASySmayo2017_eq00112265347517420439.png" alt="$\omega&gt;&gt;a$"> entonces</p><p><img src="Practica8ASySmayo2017_eq07841918573687537385.png" alt="$$\angle H(j\omega )=-{ tan }^{ -1 }\left( \frac { \omega  }{ a }  \right) \approx -90$$"></p><p>&iquest;Qu&eacute; pasa cuando <img src="Practica8ASySmayo2017_eq05177830494923879950.png" alt="$\omega=a$">?</p><pre class="codeinput">figure
hold <span class="string">on</span>
<span class="comment">% Iteraci&oacute;n sobre diferentes valores</span>
<span class="keyword">for</span> i = 1:5
	bode(tf(1,[ 1/(10^i) 1]))
	pause(0.5)
	drawnow
<span class="keyword">end</span>
grid <span class="string">on</span>
legend(<span class="string">'a = 10'</span>,<span class="string">'a = 100'</span>,<span class="string">'a = 1000'</span>,<span class="string">'a = 10000'</span>,<span class="string">'a = 100000'</span>,<span class="string">'Location'</span>,<span class="string">'SW'</span>)
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_08.png" alt=""> <p>Se puede deducir de manera semejante si el factor esta en el numerador claro que habra un peque&ntilde;o cambio de signo por las porpiedades de la funci&oacute;n logaritmo</p><pre class="codeinput">figure
hold <span class="string">on</span>
<span class="comment">% Iteraci&oacute;n sobre diferentes valores</span>
<span class="keyword">for</span> i = 1:5
    bode(tf([ 1/(10^i) 1],1))
	pause(0.5)
	drawnow
<span class="keyword">end</span>
grid <span class="string">on</span>
legend(<span class="string">'a = 10'</span>,<span class="string">'a = 100'</span>,<span class="string">'a = 1000'</span>,<span class="string">'a = 10000'</span>,<span class="string">'a = 100000'</span>,<span class="string">'Location'</span>,<span class="string">'SW'</span>)
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_09.png" alt=""> <h2>Gr&aacute;ficas de bode de factores cuadraticos<a name="10"></a></h2><p>Pensemos en la siguiente funci&oacute;n de transferencia</p><p><img src="Practica8ASySmayo2017_eq16376575229541557040.png" alt="$$H(j\omega)=\frac{1}{\left(1+2j\zeta \frac { \omega  }{ { \omega  }_{ n } } +{ \left( \frac { j\omega  }{ { \omega  }_{ n } }  \right)  }^{ 2 }\right)}$$"></p><p>La magnitud en decibeles queda como:</p><p><img src="Practica8ASySmayo2017_eq12349827015473920598.png" alt="$$20log|H(j\omega)|=-20log\left| 1+2j\zeta \frac { \omega  }{ { \omega  }_{ n } } +{ \left( \frac { j\omega  }{ { \omega  }_{ n } }  \right)  }^{ 2 } \right|$$"></p><p>Cuando <img src="Practica8ASySmayo2017_eq00252438760174612456.png" alt="$\omega<<\omega_n$"> entonces</p><p><img src="Practica8ASySmayo2017_eq15768947747153082902.png" alt="$$20log|H(j\omega)|=-20log\left| 1 \right|\approx -20log(1)=0$$"></p><p>Cuando <img src="Practica8ASySmayo2017_eq05579135307638402192.png" alt="$\omega&gt;&gt;\omega_n$"> entonces</p><p><img src="Practica8ASySmayo2017_eq18105836652365881333.png" alt="$$20log|H(j\omega)|=-20log\left| \frac {- \omega^2  }{ \omega_n^2 }  \right| \approx -40log\left( \frac { \omega  }{ \omega_n }  \right) =-40log\omega +40log\omega_n=-40u+40log(\omega_n)$$"></p><p>&iquest;Qu&eacute; pasa cuando <img src="Practica8ASySmayo2017_eq01568493163588611982.png" alt="$\omega=\omega_n$">?</p><p>La traslaci&oacute;n queda como:</p><p><img src="Practica8ASySmayo2017_eq15833535688554297683.png" alt="$$\angle H(j\omega )=-\angle \left(1+2j\zeta \frac { \omega  }{ { \omega  }_{ n } } +{ \left( \frac { j\omega  }{ { \omega  }_{ n } }  \right)  }^{ 2 }  \right) =-{ tan }^{ -1 }\left( \frac { 2\zeta \left( \frac { \omega  }{ { \omega  }_{ n } }  \right)  }{ 1-{ \left( \frac { \omega  }{ { \omega  }_{ n } }  \right)  }^{ 2 } }\right)$$"></p><p>Cuando <img src="Practica8ASySmayo2017_eq00252438760174612456.png" alt="$\omega<<\omega_n$"> entonces</p><p><img src="Practica8ASySmayo2017_eq08813171916565221965.png" alt="$$\angle H(j\omega )=-{ tan }^{ -1 }\left( \frac { 0  }{ 1 }  \right) \approx 0 $$"></p><p>Cuando <img src="Practica8ASySmayo2017_eq05579135307638402192.png" alt="$\omega&gt;&gt;\omega_n$"> entonces</p><p><img src="Practica8ASySmayo2017_eq03371013153597678992.png" alt="$$\angle H(j\omega ) \approx -180$$"></p><p>&iquest;Qu&eacute; pasa cuando <img src="Practica8ASySmayo2017_eq01568493163588611982.png" alt="$\omega=\omega_n$">?</p><pre class="codeinput">figure
hold <span class="string">on</span>
w_n=10;

<span class="comment">% Iteraci&oacute;n sobre diferentes valores</span>
<span class="keyword">for</span> zeta = 0.1:0.2:0.9
	bode(tf(1,[ 1/(w_n^2) 2*zeta/w_n  1]))
	pause(0.5)
	drawnow
<span class="keyword">end</span>
grid <span class="string">on</span>
legend(<span class="string">'\zeta = 0.1'</span>,<span class="string">'\zeta = 0.3'</span>,<span class="string">'\zeta = 0.5'</span>,<span class="string">'\zeta = 0.7'</span>,<span class="string">'\zeta = 0.9'</span>,<span class="string">'Location'</span>,<span class="string">'SW'</span>)
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_10.png" alt=""> <p>Se puede deducir de manera semejante si el factor esta en el numerador claro que habra un peque&ntilde;o cambio de signo por las porpiedades de la funci&oacute;n logaritmo</p><pre class="codeinput">figure
hold <span class="string">on</span>
w_n=10;

<span class="comment">% Iteraci&oacute;n sobre diferentes valores</span>
<span class="keyword">for</span> zeta = 0:0.3:1.2
	bode(tf([ 1/(w_n^2) 2*zeta/w_n  1],1))
	pause(0.5)
	drawnow
<span class="keyword">end</span>
grid <span class="string">on</span>
legend(<span class="string">'\zeta = 0'</span>,<span class="string">'\zeta = 0.3'</span>,<span class="string">'\zeta = 0.6'</span>,<span class="string">'\zeta = 0.9'</span>,<span class="string">'\zeta = 1.2'</span>,<span class="string">'Location'</span>,<span class="string">'SW'</span>)
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_11.png" alt=""> <h2>Analisis de un sistema de segundo orden no amortiguado<a name="12"></a></h2><p>Un sistema masa-resorte, es un ejemplo de segundo orden no amortiguado (en teoria no disipa energia). Este tipo de sistema puede ser modelelado por la siguiente ecuaci&oacute;n diferencial</p><p><img src="Practica8ASySmayo2017_eq13491007400478064634.png" alt="$$m\ddot{x}(t)+kx(t)=f(t)$$"></p><p>Donde <img src="Practica8ASySmayo2017_eq12428413953531653171.png" alt="$x$"> representa la salida del sistema (la posici&oacute;n de la masa), y <img src="Practica8ASySmayo2017_eq18096895394918367257.png" alt="$f$"> la entrada del sistema (la fuerza que se le aplica a la masa). La funci&oacute;n de transferencia asociada es la sigueinte:</p><p><img src="Practica8ASySmayo2017_eq07100966857370312531.png" alt="$$\frac{X(s)}{F(s)}=\frac{1}{ms^2+k}$$"></p><h2>Representaci&oacute;n de un sistema LTI en MATLAB<a name="13"></a></h2><pre class="codeinput">m = 1;
k = 5;
num = 1;
den = [m 0 k];
massSpring_sys = tf(num, den)
</pre><pre class="codeoutput">
massSpring_sys =
 
     1
  -------
  s^2 + 5
 
Continuous-time transfer function.

</pre><h2>Respuesta al escal&oacute;n (condiciones iniciales cero)<a name="14"></a></h2><pre class="codeinput">figure
step(massSpring_sys,10)
[y,t] = step(massSpring_sys,10);
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_12.png" alt=""> <h2>Polos y ceros del sistema<a name="15"></a></h2><pre class="codeinput">r = roots(den)
p = pole(massSpring_sys)	<span class="comment">% Poles del sistema</span>
disp(<span class="string">'Los polos del sistema son las ra&iacute;ces del denominador'</span>)
</pre><pre class="codeoutput">
r =

            0 +     2.2361i
            0 -     2.2361i


p =

            0 +     2.2361i
            0 -     2.2361i

Los polos del sistema son las ra&iacute;ces del denominador
</pre><h2>Respuesta al impulso (condiciones iniciales cero)<a name="16"></a></h2><pre class="codeinput">figure
impulse(massSpring_sys,10)
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_13.png" alt=""> <h2>Respuesta a entradas sinusoidales<a name="17"></a></h2><pre class="codeinput">t = 0:0.001:15;
wn=2.23
figure
u = sin(wn/2*t);
lsim(massSpring_sys, u, t)
title(<span class="string">'Repuesta a bajas frecuencias'</span>)
ylim([-3 3])

figure
u = sin(wn*t);
lsim(massSpring_sys, u, t)
title(<span class="string">'Repuesta a la frecuencia de resonancia'</span>)
ylim([-3 3])

figure
u2 = sin(wn*2*t);
lsim(massSpring_sys, u2, t)
title(<span class="string">'Respuesta a altas frecuencias'</span>)
ylim([-3 3])
</pre><pre class="codeoutput">
wn =

         2.23

</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_14.png" alt=""> <img vspace="5" hspace="5" src="Practica8ASySmayo2017_15.png" alt=""> <img vspace="5" hspace="5" src="Practica8ASySmayo2017_16.png" alt=""> <h2>Respuesta en frecuencia<a name="18"></a></h2><pre class="codeinput">figure
bode(massSpring_sys)
grid <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_17.png" alt=""> <h2>Modelo de suspensi&oacute;n de un carro<a name="19"></a></h2><p>El modelo de una de las cuatro suspensiones de un carro es un modelo de segundo orden. Este puede ser aproximado por un sistema masa-resorte-amortiguador. La entrada del sistema es el cambio en la altura del camino y la salida es el desplazamiento del cuerpo del carro</p><p><img vspace="5" hspace="5" src="quartercar_schematic_fbd.PNG" alt=""> </p><p>Del diagrama de cuerpo libre, se puede obtener la siguiente ecuaci&oacute;n diferencial de segundo orden para describir la din&aacute;mica de este sistema.</p><p><img src="Practica8ASySmayo2017_eq10377621918617684788.png" alt="$$m\ddot{y}(t) = k\,(u(t)-y(t)) + b\,(\dot{u}(t) - \dot{y}(t))$$"></p><p>Al tomar la transformada de Lapalce con condiciones iniciales igual a cero, se obtine la siguiente funci&oacute;n de transferencia:</p><p><img src="Practica8ASySmayo2017_eq07757296110177606499.png" alt="$$\frac{Y(s)}{U(s)} = \frac{b\,s+k}{m\,s^2+b\,s+k}$$"></p><h2>Parametros del modelo<a name="20"></a></h2><pre class="codeinput">m = 500;	<span class="comment">%kg</span>
b = 1000;	<span class="comment">%Ns/m</span>
k = 25000;	<span class="comment">%N/m</span>
</pre><h2>Funci&oacute;n de transferencia: Entrada- Salidida<a name="21"></a></h2><pre class="codeinput">car_sys = tf([b k],[m b k])
</pre><pre class="codeoutput">
car_sys =
 
       1000 s + 25000
  ------------------------
  500 s^2 + 1000 s + 25000
 
Continuous-time transfer function.

</pre><h2>Ceros y polos del sistema<a name="22"></a></h2><pre class="codeinput">r = roots([m b k])	<span class="comment">% Raices de la ecuaci&oacute;n carateristica</span>
p = pole(car_sys)	<span class="comment">% Polos del sistema</span>
pzmap(car_sys)		<span class="comment">% Visualizaci&oacute;n de los polos y ceros del sistema</span>
grid <span class="string">on</span>

disp(sprintf([<span class="string">'Los polos del sistema son equivalentes a las ra&iacute;ces'</span> <span class="keyword">...</span>
			  <span class="string">'del denominador de la funci&oacute;n de transferencia\n'</span>]))

disp(sprintf([<span class="string">'Los ceros del sistema son equivalentes a las ra&iacute;ces'</span> <span class="keyword">...</span>
			  <span class="string">'del numerador de la funci&oacute;n de transferencia\n'</span>]))
</pre><pre class="codeoutput">
r =

           -1 +          7i
           -1 -          7i


p =

           -1 +          7i
           -1 -          7i

Los polos del sistema son equivalentes a las ra&iacute;cesdel denominador de la funci&oacute;n de transferencia

Los ceros del sistema son equivalentes a las ra&iacute;cesdel numerador de la funci&oacute;n de transferencia

</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_18.png" alt=""> <h2>Respuesta del sistema al escal&oacute;n (conidiciones iniciales cero)<a name="23"></a></h2><pre class="codeinput">figure
step(car_sys)
legend(<span class="string">'Respuesta al escal&oacute;n'</span>)
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_19.png" alt=""> <h2>Respuesta al impulso (condiciones iniciales cero)<a name="24"></a></h2><pre class="codeinput">figure
impulse(car_sys)
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_20.png" alt=""> <h2>Respuesta a una entrada sinusoidal<a name="25"></a></h2><p>Se obtiene la respuesta del sistema a diferentes frecuencias</p><pre class="codeinput">t = 0:0.001:10;
wd=7;
<span class="comment">% Respuesta a bajas frecuencias</span>
figure
u1 = sin(wd/2*t);
lsim(car_sys, u1, t)
title(<span class="string">'Respuesta a bajas frecuencias'</span>)
legend(<span class="string">'Respuesta del sistema'</span>,<span class="string">'Location'</span>,<span class="string">'SE'</span>)
ylim([-4 4])

<span class="comment">% Respuesta a la frecuencia de resonancia</span>
figure
u2 = sin(wd*t);
lsim(car_sys, u2, t)
title(<span class="string">'Repuesta a la frecuencia de resonancia'</span>)
legend(<span class="string">'Respuesta del sistema'</span>,<span class="string">'Location'</span>,<span class="string">'SE'</span>)
ylim([-4 4])

<span class="comment">% Respuesta a altas frecuencias</span>
figure
u3 = sin(2*wd*t);
lsim(car_sys, u3, t)
title(<span class="string">'Repuesta a altas frecuencias'</span>)
legend(<span class="string">'Respuesta del sistema '</span>,<span class="string">'Location'</span>,<span class="string">'SE'</span>)
ylim([-4 4])
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_21.png" alt=""> <img vspace="5" hspace="5" src="Practica8ASySmayo2017_22.png" alt=""> <img vspace="5" hspace="5" src="Practica8ASySmayo2017_23.png" alt=""> <h2>Respuesta en frecuencia del sistema<a name="26"></a></h2><pre class="codeinput"><span class="comment">% Gr&aacute;ficas de Bode</span>
figure
bode(car_sys)
grid <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_24.png" alt=""> <h2>Efectos de variar el amortiguamiento en la respuesta en frecuencia<a name="27"></a></h2><pre class="codeinput">figure
hold <span class="string">on</span>

<span class="comment">% Inicializamos las variables</span>
m = 1;
k = 5;

<span class="comment">% Iteraci&oacute;n sobre diferentes valores de amortiguamiento</span>
<span class="keyword">for</span> b = [0.1 0.5 1 2 4]
	bode(tf(1,[m b k]),{0.1,10})
	pause(0.5)
	drawnow
<span class="keyword">end</span>
grid <span class="string">on</span>
legend(<span class="string">'b = 0.1'</span>,<span class="string">'b = 0.5'</span>,<span class="string">'b = 1'</span>,<span class="string">'b = 2'</span>,<span class="string">'b = 4'</span>,<span class="string">'Location'</span>,<span class="string">'SW'</span>)
title(<span class="string">'Efecto de variar el amortiguamiento en la respuesta en frecuencia'</span>)
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_25.png" alt=""> <h2>Efecto de variar la masa en la respuesta en frecuencia<a name="28"></a></h2><pre class="codeinput">figure
hold <span class="string">on</span>

b = 0.6;
k = 5;

<span class="comment">% Iteraci&oacute;n sobre diferentes valores de la masa</span>
<span class="keyword">for</span> m = 2:6
	bode(tf(1,[m b k]))
	pause(0.5)
	drawnow
<span class="keyword">end</span>
grid <span class="string">on</span>
legend(<span class="string">'m = 2'</span>,<span class="string">'m = 3'</span>,<span class="string">'m = 4'</span>,<span class="string">'m = 5'</span>,<span class="string">'m = 5'</span>,<span class="string">'Location'</span>,<span class="string">'SW'</span>)
title(<span class="string">'Efecto de variar la masa en la respuesta en frecuencia'</span>)
hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="Practica8ASySmayo2017_26.png" alt=""> <h2>Simulaci&oacute;n mediante c&oacute;digo:<a name="29"></a></h2><p>El siguiente sistema es un ciruito electrico RLC en serie, donde la estrada es el voltaje suministrado al circuito y la salida es el voltaje en la resistencia,</p><p><img vspace="5" hspace="5" src="RLC_schematic.PNG" alt=""> </p><p>realiza lo siguiente</p><div><ul><li>Demuestra que la ecuaci&oacute;n que modela el sistema es</li></ul></div><p><img src="Practica8ASySmayo2017_eq17665202625424679462.png" alt="$$\ddot{V}_o(t)+\frac{R}{L}\dot{V}_o(t)+\frac{1}{LC}V_o(t) = \frac{R}{L}\dot{V_i}(t)$$"></p><p>Ayuda: Voltaje suministrado es igual a voltaje consumido, escribir las variables en terminos de la salida mediante las relaciones de voltaje corriente en cada elemento y utilizar el hecho de que es un circuito en serie</p><div><ul><li>Demuestra que la funci&oacute;n de transferencia es:</li></ul></div><p><img src="Practica8ASySmayo2017_eq13671781099698967093.png" alt="$$H(s)=\frac{(R/L)s}{s^2+(R/L)s+(1/LC)}$$"></p><p>En adelante suponga que <img src="Practica8ASySmayo2017_eq15053406074287739616.png" alt="$L=1 H$">, <img src="Practica8ASySmayo2017_eq13162323216580847818.png" alt="$C=100\,\mu F$"> y <img src="Practica8ASySmayo2017_eq15534206494887012392.png" alt="$R=10\, K\Omega$"></p><div><ul><li>Reporta el c&oacute;digo y la gr&aacute;fica de la respuesta al impulso</li></ul></div><div><ul><li>Reporta el codigo y la gr&aacute;fica de la respuesta al escal&oacute;n</li></ul></div><p>Define <img src="Practica8ASySmayo2017_eq03865254568685440926.png" alt="$\omega_0=1/\sqrt(L*C)$"></p><div><ul><li>Presenta las simulaciones de 5 segundos con una entrada seno de de amplitud 1 con frecuencias, <img src="Practica8ASySmayo2017_eq12472746766535792522.png" alt="$\frac{1}{2}\omega_0$">, <img src="Practica8ASySmayo2017_eq08013314814671814516.png" alt="$\omega_0$">, y <img src="Practica8ASySmayo2017_eq10185657534303922379.png" alt="$2\omega_0$"></li></ul></div><div><ul><li>Reporta las gr&aacute;ficas de Bode para los valores de <img src="Practica8ASySmayo2017_eq03442895190380135198.png" alt="$R$"> y <img src="Practica8ASySmayo2017_eq03986222445007418011.png" alt="$C$"> propuestos y varia <img src="Practica8ASySmayo2017_eq11904963258706611165.png" alt="$L$"> de 1 a 1e-6</li></ul></div><h2>Simulaci&oacute;n con simulink<a name="30"></a></h2><p>Para las siguientes ecuaciones obtenga</p><p><img vspace="5" hspace="5" src="ecu1.png" alt=""> </p><div><ol><li>La soluci&oacute;n anal&iacute;tica mediante transformada de Laplace</li><li>La gr&aacute;fica de la soluci&oacute;n anal&iacute;tica, puede presentar diferentes intervalos en la grafica y acercamientos a la gr&aacute;fica seg&uacute;n considere necesario.</li><li>El diagrama de la realizaci&oacute;n elegida para SImulink, indicando, en caso de que no sea claro, el valor de cada par&aacute;metro en Simulink, por ejemplo, reportar las condiciones Iniciales de simulaci&oacute;n ya que no son visibles a simple vista desde el esquema de realizaci&oacute;n.</li><li>La grafica de la soluci&oacute;n en Simulink, puede presentar diferentes intervalos en la grafica y acercamientos a la gr&aacute;fica seg&uacute;n considere necesario.</li><li>La gr&aacute;fica, en la misma figura, de la Simulaci&oacute;n y la soluci&oacute;n anal&iacute;tica.</li><li>En caso de que la entrada sea una funci&oacute;n senoidal: * Encuentre el escalamiento y desfasamiento de la respuesta forzada a partir de la evaluaci&oacute;n de la funci&oacute;n de transferencia (soluci&oacute;n anal&iacute;tica). *	Encuentre el escalamiento y desfasamiento de la respuesta forzada a partir de las gr&aacute;ficas de Bode generadas en Matlab  (soluci&oacute;n num&eacute;rica). *	Verifique que concuerde la soluci&oacute;n anal&iacute;tica y la soluci&oacute;n num&eacute;rica</li><li>Conclusiones en caso de que considere necesario realizar comentarios al respecto.</li></ol></div><h2>Simulaci&oacute;n<a name="31"></a></h2><p>Un p&eacute;ndulo doble oscila en un plano vertical bajo la acci&oacute;n de la gravedad. Para desplazamientos peque&ntilde;os <img src="Practica8ASySmayo2017_eq11066774799090172276.png" alt="$\theta_1(t)$"> y <img src="Practica8ASySmayo2017_eq00509787607673738456.png" alt="$\theta_2(t)$">, es posible demostrar que las ecuaciones diferenciales del movimiento (para &aacute;ngulos peque&ntilde;os) son:</p><p><img src="Practica8ASySmayo2017_eq17176800161030461054.png" alt="$$ (m_1+m_2)l_1^2\ddot{\theta_1}(t)+m_2l_1l_2\ddot{\theta_2}(t)+(m_1+m_2)l_1g\theta_1(t)=0$$"></p><p><img src="Practica8ASySmayo2017_eq10485034359302715337.png" alt="$$m_2l_2^2\ddot{\theta}_2+m_2l_1l_2\ddot{\theta_1}+m_2l_2g\theta_2(t)=0$$"></p><p>Resuelva el sistema con simulink y expl&iacute;cito con: <img src="Practica8ASySmayo2017_eq00786909496420729905.png" alt="$m_1=0.1$">, <img src="Practica8ASySmayo2017_eq15602869864492907101.png" alt="$m_2=0.1$">, <img src="Practica8ASySmayo2017_eq15147460706885708536.png" alt="$l_1=l_2=1$">, <img src="Practica8ASySmayo2017_eq02641250903781312135.png" alt="$\theta_1(0)=-1$">, <img src="Practica8ASySmayo2017_eq09574318526791701494.png" alt="$\theta_2(0)=1$">, <img src="Practica8ASySmayo2017_eq12830856720803665175.png" alt="$\dot{\theta_1}(0)=0$"> <img src="Practica8ASySmayo2017_eq04913149351752566599.png" alt="$\dot{\theta_2}(0)=0$">.</p><p><img vspace="5" hspace="5" src="pendulo.png" alt=""> </p><p>Puedes consultar el siguiente documento para la soluci&oacute;n expl&iacute;cita <a href="https://www.mathworks.com/help/symbolic/solve-differential-equations-using-laplace-transform.html">enlace</a></p><p class="footer">Copyright 1984-2009 The MathWorks, Inc.<br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2016a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Práctica 7:  Respuesta en frecuencia, Simulink 
%
% Los filtros (sistemas LTI) son importantes en el área de procesamiento de señales.
% Las caracteristicas del filtrado de un sistema diferencial LTI (ecuación 
% diferencial con coeficientes constantes y condicinones iniciales cero) 
% están determinadas por lo siguiente:
%
% Si la entrada a un sistema BIBO-estable es
% 
% $$x(t)= A\cos(\omega t + \theta)u(t)$$
% 
%
% La salida en estado estacionario (coincide con la particular o forzada), para 
% un sistema asintoticamente estable, será
%
% $$y_{ss}(t)=A|H(j\omega)|\cos(\omega t+ \theta + ang H(j\omega))u(t)$$
%
% Podemos decir lo siguiente: Si una señal coseno (o seno) es la entrada de 
% un sistema LTI BIBO-estable y asintoticamente estable, la respuesta 
% en estado estacionario es un escalamiento vertical y una traslación horizontal 
% de la señal de entrada.
%
% Si el escalamiento vertical dado es muy pequeño 
% $|H(j\omega)|<< 1$ la respuesta en estado estacionario tiene un efecto 
% despreciable en la salida del sistema, entonces
% diremos que el sistema filtra a esta señal ("no la deja pasar para llegar
% a la salida del sistema", por lo que los sistemas LTI son filtros) pero esto
% no siempre es el caso, podría suceder que el escalamiento vertical no sea
% tan pequeño, entonces la respuesta en estado estacionario no sería
% despreciable
%
% El escalamiento vertical depende de dos cosas, de la estructura del sistema
% (cuantas derivadas hay en la entrada y la salida y los coeficientes de estas)
% y de los valores de $\omega$.  Así para un sistema fijo $H$ el
% escalamiento vertical y la traslación horizontal (o desfasamiento)
% depende solo de los  valos de $\omega$, esto es, 
% de la frecuencia de la entrada (ya sea una función seno o coseno).
% Entonces sería conveniente tener registrados los escalamientos y 
% traslaciones de la señal de salida en estado estacionario de alguna manera.  
%
% A la expresión $H(j\omega)$ se le conoce como la respuesta en *frecuencia
% del sistema* (es decir, la respuesta en frecuencia es la función de 
% transferencia en el formato de transformada de Fourier) y la manera 
% de registrar la información que contiene es mediante las
% gráficas $|H(j\omega)|$ contra $\omega$ (gráfica de magnitud) y 
% $ang(H(j\omega))$  contra $\omega$ (gráfica de fase)
% (con $\omega$ de 0 a $\infty$) 
% y precisamente estas gráficas nos ayudan a interpretar el sistema como
% filtro, estás gráficas son las que se estudian cuando se habla de la
% respuesta en frecuencia mas que la espresión análitica $H(j\omega)$ en si. 
%% Ejemplo:
% Encuentra la respuesta en frecuencia de
%%
% 
% $$\ddot{y}+3\dot{y}+2y=\dot{x}+5x$$
% 
% ¿Cuál es la respuesta en estado estacionario cuando la entrada es $x(t)=20sen(3t+2)$?
%
% Se suele utilizar a la letra $s$ para escribir a la función de
% transferencia, aunque en este estudio nos conviene ver a la función de
% transferecia en su notación de transformada de Fourier, así sustituimos a
% $s=j\omega$
% 
% $$H(s)=\frac{P(s)}{Q(s)}=\frac{s+5}{s^2+3s+2}$$
% 
% $$H(j\omega)=\frac{j\omega+5}{(j\omega)^2+3(j\omega)+2}=\frac{5+\omega j}{2-\omega^2+3\omega j}$$
%
% Aquí $\omega=3$, entonces
%
% $$H(3j)=\frac{j3+5}{(j3)^2+3(j3)+2}=\frac{5+3j}{-7+9j}$$
% 
% $$|H(3j)|=\frac{5.831}{11.402}=0.51141$$
%
% $$ang H(3j)=0.54042-2.2318=-1.6914$$
% 
% Entonces la respuesta en estado estacionario es
%
% $$y_{ss}(t)=20(0.51141)sen(3t+2-1.6914)u(t)=10.228sen(3t+0.3086)u(t)$$
%
% Ahora podemos resolver este sistema para condiciones iniciales cero y la
% entrada establecida, observemos que la solución es la respuesta total y en
% principio la solución  no permite mostrar la respuesta en estado 
% estacionario encontrada, pero mediante simplificación se puede ver 
% que coicide con la solución del ejemplo anterior. 
% Este sistema es asintoticamente estable y por lo tanto BIBO estable, 
% entonces la respuesta transitoria tiende a ser despreciable despúes de
% un largo tiempo, entonces si gráficamos la respuesta estacionario 
% encontrada en el ejemplo anterior tenemos que  
%
syms t
rg=laplace2016am([2 3 1],[5 1],[0 0],[0],20*sin(3*t+2)*heaviside(t),10);
tt=0:0.01:10;
plot(rg,tt,10.228*sin(3*tt+0.3086),'k')
%%
% La función |laplace2016am| es una modificación de un programa que ya
% hemos utilizado donde nos regresa una ubicación para gráficar en donde
% corresponde a la respuesta en estado estacionario, no hay mayor
% importancia en esto solo es para un despliegue más amigable. 
%
% A continuación calculamos la gráfica de Magnitud y de fase para el
% sistema antes mencionado, mediante la defición directa y mediante la
% herramienta de Matlab con la intrucción |bode|. Además observamos que
% estas gráfica tienen la información de la magnitud y angulo para
% diferentes valores de $\omega$ en particuñar cuando $\omega=3$,
% hay que tener cuidado por lo regular la gráfica de fase se reporta en 
% grados.

w = [0:0.1:100];
absH =inline('(25+w.^2).^0.5./((2-w.^2).^2+9*w.^2).^.5','w');
angH = inline('atan2d(w,5)-atan2d(3*w,(2-w.^2))','w');
figure
subplot(1,2,1)

plot(w,absH(w))
hold on
p2=plot(3,absH(3),'ro');
legend(p2,'Escalamiento para w=3')
grid on
title('|H(j\omega)|')
xlabel('\omega')

subplot(1,2,2)
plot(w,angH(w))
hold on
p3=plot(3,angH(3),'ro');
legend(p3,'traslación (en grados) para w=3')
grid on
title('\angle H(j\omega)')
xlabel('\omega')

sistema = tf([1 5],[1 3 2])

[m,a,wb] = bode(sistema);
mm = squeeze(m);
aa = squeeze(a);

figure
subplot(1,2,1)
plot(wb,mm)
grid on
title('|H(j\omega)|')
xlabel('\omega')

subplot(1,2,2)
plot(wb,aa)
grid on
title('\angle H(j\omega)')
xlabel('\omega')

%% Gráficas de Bode
%
% Las gráficas de Bode son escalas de las graficas de magnitud y fase,
% estas escalas se remontan a la decada de 1930-1940,
% nos permiten elaborar las gráficas de una manera "amigable"
% y tienen una mejor visualización que las escalas naturales,
% aunque en un principio la interpretación de la magnitud y el desplazamiento (fase)
% pueden parecer un poco extrañas, son las mismas que hemos 
% comentado anteriormente.
% 
% La gráfica de magnitud de bode es gráficar $20 log_{10}(|H(j\omega)|)$,
% contra $log_{10}(\omega)$. 
%
% La gráfica de fase de bode es gráficar $ang(|H(j\omega)|)$,
% contra $log_{10}(\omega)$. 
%
% Tenemos la siguiente definición, si a un número positivo $a$ le realizamos la 
% operacion de la forma $20log_{10}(a)$ diremos que el resultado es el 
% valor en decibeles del número a, es decir la gráfica de Bode 
% de magnitud se mide en decibeles.
%
% Pensemos en la siguiente función de transferencia
%   
% $$H(s)=\frac { K(s+{ a }_{ 1 })(s+{ a }_{ 2 }) }{ s(s+b_{ 1 })({ s }^{ 2 }+{ b }_{ 2 }s+{ b }_{ 3 }) } $$
%   
%   
% Factorizamos las constantes necesarias de tal manera que el termino independiente de cada componente de la factorización sea uno. Esto servirá para el análisis posterior
%   
%   
% $$H(s)=\frac { K{ a }_{ 1 }{ a }_{ 2 } }{ { b }_{ 1 }{ b }_{ 3 } } \frac { \left( \frac { s }{ { a }_{ 1 } } +1 \right) \left( \frac { s }{ { a }_{ 2 } } +1 \right)  }{ s\left( \frac { s }{ { b }_{ 1 } } +1 \right)\left( \frac { s^{ 2 } }{ { b }_{ 3 } } +\frac { { b }_{ 2 } }{ { b }_{ 3 } } s+1 \right)  } 
% $$
%   
% Sustituimos $s=j\omega$ para encontrar la función del escalamiento y traslación  
%   
%   
% $$
% H(j\omega )=\frac { K{ a }_{ 1 }{ a }_{ 2 } }{ { b }_{ 1 }{ b }_{ 3 } } \frac { \left( 1+\frac { j\omega  }{ { a }_{ 1 } }  \right) \left( 1+\frac { j\omega  }{ { a }_{ 2 } }  \right)  }{ j\omega \left( 1+\frac { j\omega  }{ { b }_{ 1 } }  \right) \left[ 1+j\frac { { b }_{ 2 }\omega  }{ { b }_{ 3 } } +\frac { { (j\omega ) }^{ 2 } }{ { b }_{ 3 } }  \right]  } 
% $$
%   
% Así la magnitud del escalamiento queda como
%   
% $$
% \left| H(j\omega ) \right| =\frac { K{ a }_{ 1 }{ a }_{ 2 } }{ { b }_{ 1 }{ b }_{ 3 } } \frac { \left| 1+\frac { j\omega  }{ { a }_{ 1 } }  \right| \left| 1+\frac { j\omega  }{ { a }_{ 2 } }  \right|  }{ \left| j\omega  \right| \left| 1+\frac { j\omega  }{ { b }_{ 1 } }  \right| \left| 1+j\frac { { b }_{ 2 }\omega  }{ { b }_{ 3 } } +\frac { { (j\omega ) }^{ 2 } }{ { b }_{ 3 } }  \right|  } 
% $$
%   
% Y la traslación 
%   
% $$
% \angle H(j\omega )=\angle\left(\frac { K{ a }_{ 1 }{ a }_{ 2 } }{ { b }_{ 1 }{ b }_{ 3 } }\right)+\angle \left( 1+\frac { j\omega  }{ { a }_{ 1 } }  \right) +\angle \left( 1+\frac { j\omega  }{ { a }_{ 2 } }  \right) -\angle j\omega -\angle \left( 1+\frac { j\omega  }{ { b }_{ 1 } }  \right) -\angle \left[ 1+j\frac { { b }_{ 2 }\omega  }{ { b }_{ 3 } } +\frac { { (j\omega ) }^{ 2 } }{ { b }_{ 3 } }  \right] 
% $$
%   
%   
% El valor en decibeles de la magnitud queda como
% 
% $$ 20log\left| H(j\omega ) \right| =20log\left|\frac { K{ a }_{ 1 }{ a }_{ 2 } }{ { b }_{ 1 }{ b }_{ 3 } } \right|+20log\left| 1+\frac { j\omega  }{ { a }_{ 1 } }  \right| +20log\left| 1+\frac { j\omega  }{ { a }_{ 2 } }  \right| -20log\left| j\omega  \right| -20log\left| 1+\frac { j\omega  }{ { b }_{ 1 } }  \right|  \\
% -20log\left| 1+j\frac { { b }_{ 2 }\omega  }{ { b }_{ 3 } } +\frac { {
% (j\omega ) }^{ 2 } }{ { b }_{ 3 } } \right| $$
%      
%% Gráficas de bode de constantes
% Si la función de transferencia es una constante, la grafica de la magnitud 
% son lineas horizontales y la fase es de $0$ o $180$ grados dependiendo del signo
% Pensemos en la siguiente función  de transferencia:
% 
% $$H(j\omega)=a\;\; a\in R$$
%
% $$20log|H(j\omega)|=20log|a|$$
%
% Para a positiva $ang(H(j\omega))=0$ y para a negativa $ang(H(j\omega))=180$
figure
bode(5,1)
figure
bode(-5,1)
% 
%% Gráficas de bode de potencias
% Pensemos en la siguiente función  de transferencia:
% 
% $$H(j\omega)=\frac{1}{jw}$$
%
% La magnitud en decibeles queda como:
%
% $$20log|H(j\omega)|=-20log|\omega|=-20log(\omega)=-20u$$
%
% La traslación queda como:
%
% $$\angle H(j\omega )=-\angle \left( j\omega \right)=- 90$$
%
figure
hold on
% Iteración sobre diferentes valores
d=[1];
for i = 1:4
    d=[d 0];
	bode(tf(1,d))
	pause(0.5)
	drawnow
end
grid on
legend('1/(j\omega)^1','1/(j\omega)^2','1/(j\omega)^3','1/(j\omega)^4','Location','SW')
hold off
%%
% Se puede deducir de manera semejante si el factor esta en el numerador
% claro que habra un pequeño cambio de signo por las porpiedades de la
% función logaritmo
figure
hold on
% Iteración sobre diferentes valores
n=[1];
for i = 1:4
    n=[n 0];
	bode(tf(n,1))
	pause(0.5)
	drawnow
end
grid on
legend('(j\omega)^1','(j\omega)^2','(j\omega)^3','(j\omega)^4','Location','SW')
hold off

%% Gráficas de bode de factores lineales
% Pensemos en la siguiente función de transferencia 
%
% $$H(j\omega)=\frac{1}{\left(1+\frac{j\omega}{a}\right)}$$
%
% La magnitud en decibeles queda como:
%
% $$20log|H(j\omega)|=-20log\left| 1+\frac { j\omega  }{ a } \right|$$
% 
% Cuando $\omega<<a$ entonces
%
% $$20log|H(j\omega)|=-20log\left| 1+\frac { j\omega  }{ a } \right|\approx -20log(1)=0$$
%
% Cuando $\omega>>a$ entonces
%
% $$20log|H(j\omega)|=-20log\left| 1+\frac { j\omega  }{ a }  \right| \approx -20log\left( \frac { \omega  }{ a }  \right) =-20log\omega +20loga=-20u+20log(a)$$
%
% ¿Qué pasa cuando $\omega=a$?
%
% La traslación queda como:
%
% $$\angle H(j\omega )=-\angle \left( 1+\frac { j\omega  }{ a }  \right) =-{ tan }^{ -1 }\left( \frac { \omega  }{ a }  \right)$$
%
% Cuando $\omega<<a$ entonces
%
% $$\angle H(j\omega )=-{ tan }^{ -1 }\left( \frac { \omega  }{ a }  \right) \approx 0 $$
%
% Cuando $\omega>>a$ entonces
%
% $$\angle H(j\omega )=-{ tan }^{ -1 }\left( \frac { \omega  }{ a }  \right) \approx -90$$
%
% ¿Qué pasa cuando $\omega=a$?
%
figure
hold on
% Iteración sobre diferentes valores
for i = 1:5
	bode(tf(1,[ 1/(10^i) 1]))
	pause(0.5)
	drawnow
end
grid on
legend('a = 10','a = 100','a = 1000','a = 10000','a = 100000','Location','SW')
hold off
%%
% Se puede deducir de manera semejante si el factor esta en el numerador
% claro que habra un pequeño cambio de signo por las porpiedades de la
% función logaritmo
%
figure
hold on
% Iteración sobre diferentes valores
for i = 1:5
    bode(tf([ 1/(10^i) 1],1))
	pause(0.5)
	drawnow
end
grid on
legend('a = 10','a = 100','a = 1000','a = 10000','a = 100000','Location','SW')
hold off
%% Gráficas de bode de factores cuadraticos
% Pensemos en la siguiente función de transferencia 
%
% $$H(j\omega)=\frac{1}{\left(1+2j\zeta \frac { \omega  }{ { \omega  }_{ n } } +{ \left( \frac { j\omega  }{ { \omega  }_{ n } }  \right)  }^{ 2 }\right)}$$
%
% La magnitud en decibeles queda como:
%
% $$20log|H(j\omega)|=-20log\left| 1+2j\zeta \frac { \omega  }{ { \omega  }_{ n } } +{ \left( \frac { j\omega  }{ { \omega  }_{ n } }  \right)  }^{ 2 } \right|$$
% 
% Cuando $\omega<<\omega_n$ entonces
%
% $$20log|H(j\omega)|=-20log\left| 1 \right|\approx -20log(1)=0$$
%
% Cuando $\omega>>\omega_n$ entonces
%
% $$20log|H(j\omega)|=-20log\left| \frac {- \omega^2  }{ \omega_n^2 }  \right| \approx -40log\left( \frac { \omega  }{ \omega_n }  \right) =-40log\omega +40log\omega_n=-40u+40log(\omega_n)$$
%
% ¿Qué pasa cuando $\omega=\omega_n$?
%
% La traslación queda como:
%
% $$\angle H(j\omega )=-\angle \left(1+2j\zeta \frac { \omega  }{ { \omega  }_{ n } } +{ \left( \frac { j\omega  }{ { \omega  }_{ n } }  \right)  }^{ 2 }  \right) =-{ tan }^{ -1 }\left( \frac { 2\zeta \left( \frac { \omega  }{ { \omega  }_{ n } }  \right)  }{ 1-{ \left( \frac { \omega  }{ { \omega  }_{ n } }  \right)  }^{ 2 } }\right)$$
%
% Cuando $\omega<<\omega_n$ entonces
%
% $$\angle H(j\omega )=-{ tan }^{ -1 }\left( \frac { 0  }{ 1 }  \right) \approx 0 $$
%
% Cuando $\omega>>\omega_n$ entonces
%
% $$\angle H(j\omega ) \approx -180$$
%
% ¿Qué pasa cuando $\omega=\omega_n$?
%

figure
hold on
w_n=10;

% Iteración sobre diferentes valores
for zeta = 0.1:0.2:0.9
	bode(tf(1,[ 1/(w_n^2) 2*zeta/w_n  1]))
	pause(0.5)
	drawnow
end
grid on
legend('\zeta = 0.1','\zeta = 0.3','\zeta = 0.5','\zeta = 0.7','\zeta = 0.9','Location','SW')
hold off
%%
% Se puede deducir de manera semejante si el factor esta en el numerador
% claro que habra un pequeño cambio de signo por las porpiedades de la
% función logaritmo
%
figure
hold on
w_n=10;

% Iteración sobre diferentes valores
for zeta = 0:0.3:1.2
	bode(tf([ 1/(w_n^2) 2*zeta/w_n  1],1))
	pause(0.5)
	drawnow
end
grid on
legend('\zeta = 0','\zeta = 0.3','\zeta = 0.6','\zeta = 0.9','\zeta = 1.2','Location','SW')
hold off



%% Analisis de un sistema de segundo orden no amortiguado
%
% Un sistema masa-resorte, es un ejemplo de segundo orden no amortiguado 
% (en teoria no disipa energia). Este tipo de sistema puede ser modelelado
% por la siguiente ecuación diferencial
% 
% $$m\ddot{x}(t)+kx(t)=f(t)$$
% 
% Donde $x$ representa la salida del sistema (la posición de la masa), y 
% $f$ la entrada del sistema (la fuerza que se le aplica a la masa). La
% función de transferencia asociada es la sigueinte:
% 
% $$\frac{X(s)}{F(s)}=\frac{1}{ms^2+k}$$
%
%% Representación de un sistema LTI en MATLAB

m = 1;
k = 5;
num = 1;
den = [m 0 k];
massSpring_sys = tf(num, den)

%% Respuesta al escalón (condiciones iniciales cero)

figure
step(massSpring_sys,10)
[y,t] = step(massSpring_sys,10);

%% Polos y ceros del sistema 

r = roots(den)
p = pole(massSpring_sys)	% Poles del sistema
disp('Los polos del sistema son las raíces del denominador')


%% Respuesta al impulso (condiciones iniciales cero)
figure
impulse(massSpring_sys,10)

%% Respuesta a entradas sinusoidales
t = 0:0.001:15;
wn=2.23
figure
u = sin(wn/2*t);
lsim(massSpring_sys, u, t)
title('Repuesta a bajas frecuencias')
ylim([-3 3])

figure
u = sin(wn*t);
lsim(massSpring_sys, u, t)
title('Repuesta a la frecuencia de resonancia')
ylim([-3 3])

figure
u2 = sin(wn*2*t);
lsim(massSpring_sys, u2, t)
title('Respuesta a altas frecuencias')
ylim([-3 3])

%% Respuesta en frecuencia

figure
bode(massSpring_sys)
grid on


%% Modelo de suspensión de un carro
%
% El modelo de una de las cuatro suspensiones de un carro es un 
% modelo de segundo orden. Este puede ser aproximado por un sistema 
% masa-resorte-amortiguador. La entrada del sistema es el cambio en la
% altura del camino y la salida es el desplazamiento del cuerpo del carro
%
% <<quartercar_schematic_fbd.PNG>>
% 
% Del diagrama de cuerpo libre, se puede obtener la siguiente ecuación
% diferencial de segundo orden para describir la dinámica de este sistema.
%
% $$m\ddot{y}(t) = k\,(u(t)-y(t)) + b\,(\dot{u}(t) - \dot{y}(t))$$
%
%
% Al tomar la transformada de Lapalce con condiciones iniciales 
% igual a cero, se obtine la siguiente función de transferencia:
% 
%
% $$\frac{Y(s)}{U(s)} = \frac{b\,s+k}{m\,s^2+b\,s+k}$$
%
%
% Copyright 1984-2009 The MathWorks, Inc. 

%% Parametros del modelo
m = 500;	%kg
b = 1000;	%Ns/m
k = 25000;	%N/m

%% Función de transferencia: Entrada- Salidida 
car_sys = tf([b k],[m b k])

%% Ceros y polos del sistema
r = roots([m b k])	% Raices de la ecuación carateristica
p = pole(car_sys)	% Polos del sistema
pzmap(car_sys)		% Visualización de los polos y ceros del sistema
grid on

disp(sprintf(['Los polos del sistema son equivalentes a las raíces' ...
			  'del denominador de la función de transferencia\n']))

disp(sprintf(['Los ceros del sistema son equivalentes a las raíces' ...
			  'del numerador de la función de transferencia\n']))

%% Respuesta del sistema al escalón (conidiciones iniciales cero)
figure
step(car_sys)
legend('Respuesta al escalón')

%% Respuesta al impulso (condiciones iniciales cero)
figure
impulse(car_sys)

%% Respuesta a una entrada sinusoidal
% Se obtiene la respuesta del sistema a diferentes frecuencias
t = 0:0.001:10;
wd=7;
% Respuesta a bajas frecuencias
figure
u1 = sin(wd/2*t);
lsim(car_sys, u1, t)
title('Respuesta a bajas frecuencias')
legend('Respuesta del sistema','Location','SE')
ylim([-4 4])

% Respuesta a la frecuencia de resonancia
figure
u2 = sin(wd*t);
lsim(car_sys, u2, t)
title('Repuesta a la frecuencia de resonancia')
legend('Respuesta del sistema','Location','SE')
ylim([-4 4])

% Respuesta a altas frecuencias
figure
u3 = sin(2*wd*t);
lsim(car_sys, u3, t)
title('Repuesta a altas frecuencias')
legend('Respuesta del sistema ','Location','SE')
ylim([-4 4])

%% Respuesta en frecuencia del sistema

% Gráficas de Bode
figure
bode(car_sys)
grid on

%% Efectos de variar el amortiguamiento en la respuesta en frecuencia

figure
hold on

% Inicializamos las variables
m = 1;
k = 5;

% Iteración sobre diferentes valores de amortiguamiento
for b = [0.1 0.5 1 2 4]
	bode(tf(1,[m b k]),{0.1,10})
	pause(0.5)
	drawnow
end
grid on
legend('b = 0.1','b = 0.5','b = 1','b = 2','b = 4','Location','SW')
title('Efecto de variar el amortiguamiento en la respuesta en frecuencia')
hold off


%% Efecto de variar la masa en la respuesta en frecuencia

figure
hold on

b = 0.6;
k = 5;

% Iteración sobre diferentes valores de la masa
for m = 2:6
	bode(tf(1,[m b k]))
	pause(0.5)
	drawnow
end
grid on
legend('m = 2','m = 3','m = 4','m = 5','m = 5','Location','SW')
title('Efecto de variar la masa en la respuesta en frecuencia')
hold off

%% Simulación mediante código:
%
% El siguiente sistema es un ciruito electrico RLC en serie, donde la
% estrada es el voltaje suministrado al circuito y la salida es el voltaje
% en la resistencia,
% 
% <<RLC_schematic.PNG>>
% 
% realiza lo siguiente 
% 
% * Demuestra que la ecuación que modela el sistema es 
%
% $$\ddot{V}_o(t)+\frac{R}{L}\dot{V}_o(t)+\frac{1}{LC}V_o(t) = \frac{R}{L}\dot{V_i}(t)$$
%  
% Ayuda: Voltaje suministrado es igual a voltaje consumido, escribir las
% variables en terminos de la salida mediante las relaciones de voltaje
% corriente en cada elemento y utilizar el hecho de que es un circuito en
% serie
% 
% * Demuestra que la función de transferencia es: 
% 
% $$H(s)=\frac{(R/L)s}{s^2+(R/L)s+(1/LC)}$$
%
% En adelante suponga que $L=1 H$, $C=100\,\mu F$ y $R=10\, K\Omega$
%
% * Reporta el código y la gráfica de la respuesta al impulso
%
% * Reporta el codigo y la gráfica de la respuesta al escalón
%
% Define $\omega_0=1/\sqrt(L*C)$
%
% * Presenta las simulaciones de 5 segundos con una entrada seno de 
% de amplitud 1 con frecuencias, $\frac{1}{2}\omega_0$, $\omega_0$, y $2\omega_0$
%
% * Reporta las gráficas de Bode para los valores de $R$ y $C$ propuestos y
% varia $L$ de 1 a 1e-6
%% Simulación con simulink
% Para las siguientes ecuaciones obtenga
%
% <<ecu1.png>>
% 
% # La solución analítica mediante transformada de Laplace  
% # La gráfica de la solución analítica, puede presentar diferentes 
% intervalos en la grafica y acercamientos a la gráfica según considere necesario.
% # El diagrama de la realización elegida para SImulink, indicando, en caso
% de que no sea claro, el valor de cada parámetro en Simulink, por ejemplo,
% reportar las condiciones Iniciales de simulación ya que no son visibles 
% a simple vista desde el esquema de realización.
% # La grafica de la solución en Simulink, puede presentar diferentes 
% intervalos en la grafica y acercamientos a la gráfica según considere necesario.
% # La gráfica, en la misma figura, de la Simulación y la solución analítica.
% # En caso de que la entrada sea una función senoidal: 
% * Encuentre el escalamiento y desfasamiento de la respuesta forzada a 
% partir de la evaluación de la función de transferencia (solución analítica).
% *	Encuentre el escalamiento y desfasamiento de la respuesta forzada a partir 
% de las gráficas de Bode generadas en Matlab  (solución numérica).
% *	Verifique que concuerde la solución analítica y la solución numérica
% # Conclusiones en caso de que considere necesario realizar comentarios al respecto.
%% Simulación 
% Un péndulo doble oscila en un plano vertical bajo la acción de la gravedad. 
% Para desplazamientos pequeños $\theta_1(t)$ y $\theta_2(t)$, es posible 
% demostrar que las ecuaciones diferenciales del movimiento (para ángulos
% pequeños) son:

%%
% 
% $$ (m_1+m_2)l_1^2\ddot{\theta_1}(t)+m_2l_1l_2\ddot{\theta_2}(t)+(m_1+m_2)l_1g\theta_1(t)=0$$
% 
% $$m_2l_2^2\ddot{\theta}_2+m_2l_1l_2\ddot{\theta_1}+m_2l_2g\theta_2(t)=0$$
% 
% Resuelva el sistema con simulink y explícito con: $m_1=0.1$, $m_2=0.1$, 
% $l_1=l_2=1$, $\theta_1(0)=-1$, $\theta_2(0)=1$, $\dot{\theta_1}(0)=0$ 
% $\dot{\theta_2}(0)=0$. 
%
% <<pendulo.png>>
%
% Puedes consultar el siguiente documento para la solución explícita 
% <https://www.mathworks.com/help/symbolic/solve-differential-equations-using-laplace-transform.html enlace>





##### SOURCE END #####
--></body></html>